}
plotar <- data.frame(dias=Tempo,Obs=Obs)
ggplot(data=plotar,aes(x=a, y=Obs, group=1)) + geom_line()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1, colour=factor(cyl))) + geom_line()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1, colour="green")) + geom_line()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1, colour="red")) + geom_line()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour="red")
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour="darkblue")
?geom_line
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(aes(colour="darkblue",size=10))
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour="darkblue",size=10)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour="darkblue",size=4)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour="darkblue",size=2)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour="darkblue",size=1,5)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour="darkblue",size=1.5)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour="darkblue",size=Obs)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour=Obs,size=1.5)
scales::seq_gradient_pal(low = "#132B43", high = "#56B1F7", space = "Lab")
escala <-scales::seq_gradient_pal(low = "#132B43", high = "#56B1F7", space = "Lab")
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour=escala,size=1.5)
scales::seq_gradient_pal(low = "#132B43", high = "#56B1F7", space = "Lab")
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour=escala,size=1.5)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(color=Tribe,size=1.5)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(aes(colour=escala,size=1.5))
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(aes(colour=escala),size=1.5)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(colour=Obs,size=1.5)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(size=1.5)+ scale_fill_hue()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(size=1.5)+  scale_colour_hue()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(size=1.5)+  scale_fill_hue(c=45, l=80)
install.packages("RColorBrewer")
library(RColorBrewer)
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(size=1.5)+scale_colour_brewer()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_line(size=1.5) + scale_colour_brewer()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_bars() + scale_colour_brewer()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_bar() + scale_colour_brewer()
ggplot(data=plotar,aes(x=Tempo, y=Obs, group=1)) + geom_bar()
ggplot(data=plotar,aes(x=Tempo, y=Obs)) + geom_bar()
?geom_bar
ggplot(plotar,aes(Obs, fill=Tempo)) + geom_bar()
ggplot(plotar,aes(Obs, fill=Obs)) + geom_bar()
ggplot(plotar,aes(Obs)) + geom_bar()
ggplot(data=plotar,aes(x=Tempo, y=Obs)) + geom_bar()
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Obs)) + geom_bar()
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo)) + geom_bar()
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo)) + geom_bar( stat="identity" )
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo)) + geom_bar(stat="identity")
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo)) + geom_bar(stat="identity") + scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo)) + geom_bar(stat="identity") + scale_fill_brewer()
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))
+ geom_bar(stat="identity")
+ scale_fill_brewer(palette="Set1")
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))
+ geom_bar(stat="identity")
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))+geom_bar(stat="identity")
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))+geom_bar(stat="identity")+scale_fill_hue(l=40)
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))+geom_bar(stat="identity")+scale_fill_gradient()
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))+geom_bar(stat="identity")+scale_fill_gradient(low="green",high="darkgreen")
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))+geom_bar(stat="identity")
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))+geom_bar(stat="identity", colour="darkblue")
ggplot(data=plotar,aes(x=Tempo, y=Obs, fill=Tempo))+geom_bar(stat="identity", color="darkblue")
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", color="darkblue")
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity")+scale_fill_gradient(low="green",high="darkgreen")
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity")
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")+scale_fill_hue(l=40)
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")+ scale_colour_hue()
ggplot(data=plotar,aes(x=Tempo, y=Obs,fill=Tempo))+geom_bar(stat="identity", colour="darkblue")+ scale_colour_hue()
scale_fill_manual(values=cbPalette)
ggplot(data=plotar,aes(x=Tempo, y=Obs,fill=Tempo))+geom_bar(stat="identity", colour="darkblue")+ scale_colour_hue()
ggplot(data=plotar,aes(x=Tempo, y=Obs,fill=Tempo))+geom_bar(stat="identity", colour="darkblue")+scale_fill_brewer()
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")+scale_fill_brewer()
library(ggplot2)
library(RColorBrewer)
directory <- "F://Drive//Business//Inflacao//Output//"
fontes <- list.files(directory,,pattern="csv")
base <-NULL
for (i in 1:10){
dest <- paste(directory, fontes[i], sep="")
b1 <- read.csv(dest, sep=";", header=FALSE)
base <- rbind(base,b1)
}
nomes <-  c("Fonte","Data","hora","Cat","Sku","Preço")
colnames(base)<-nomes
BaseS <- split(base,base$Data)
Observacoes <- lapply(BaseS,nrow)
Obs<- as.numeric(Observacoes)
dias <- names(Observacoes)
Tempo <- as.Date(dias[1],"%d/%m/%Y")
for (i in 1:length(Obs)){
Tempo[i] <- as.Date(dias[i],"%d/%m/%Y")
}
#dias <- lapply(dias,as.Date,"%d/%m/%Y")
#dias <- unlist(dias)
plotar <- data.frame(dias=Tempo,Obs=Obs)
scale_fill_manual(values=cbPalette)
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")+scale_fill_brewer()
library(ggplot2)
library(RColorBrewer)
directory <- "F://Drive//Business//Inflacao//Output//"
fontes <- list.files(directory,,pattern="csv")
base <-NULL
for (i in 1:10){
dest <- paste(directory, fontes[i], sep="")
b1 <- read.csv(dest, sep=";", header=FALSE)
base <- rbind(base,b1)
}
nomes <-  c("Fonte","Data","hora","Cat","Sku","Preço")
colnames(base)<-nomes
BaseS <- split(base,base$Data)
Observacoes <- lapply(BaseS,nrow)
Obs<- as.numeric(Observacoes)
dias <- names(Observacoes)
Tempo <- as.Date(dias[1],"%d/%m/%Y")
for (i in 1:length(Obs)){
Tempo[i] <- as.Date(dias[i],"%d/%m/%Y")
}
#dias <- lapply(dias,as.Date,"%d/%m/%Y")
#dias <- unlist(dias)
plotar <- data.frame(dias=Tempo,Obs=Obs)
scale_fill_manual(values=cbPalette)
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")+scale_fill_brewer()
install_from_swirl("R Programming")
library(swirl)
install_from_swirl("R Programming")
swirl()
5-7
35+7
5+7
x<-5+7
x
x <-5+7
x
y<-x-3
y
c(1.1, 9, 3.14)
z<- c(1.1, 9, 3.14)
?c
z
c(z,555,z)
z*2+100
my_sqrt <- sqrt(z-1)
my_sqrt
my_div <- z/my_sqrt
my)div
my_div
c(1,2,3,4)+c(0,10)
c(1,2,3,4)+c(0,10,100)
z*2+1000
my_div
getwd()
ls()
x <-9
ls()
dir()
?list.files
args(list.files)
args(list.files())
old.dir <- getwd()
dir.create("testdir")
setwd(testdir)
setwd("testdir")
file.create("mytest.R")
list.files()
dir()
file.exists("mytest.R")
file.info("mytest.R")
file.rename("mytest.R","mytest2.R")
file.copy("mytest2.R","mytest3.R")
file.patch("mytest3.R")
?file.path
file.path("mytest3.R")
file.path("mytest3.R","folder1","folder2")
file.path("folder1","folder2")
?dir.create
?dir.create
dir.create(file.path("testdir2"),"testdir3")
dir.create(file.path('testdir2', 'testdir3'), recursive = TRUE)
?unlink
unlink("testdir2")
unlink("testdir2",recursive=TRUE)
setwd(old.dir)
unlink("testdir",recursive=TRUE)
1:20
pi:10
15:1
?:
:
':'
?':'
seq(1,20)
seq(0,10,by=0.5)
seq(5,10,length=30)
my_seq <- seq(5,10,length=30)
length(my_seq)
1:lenth(my_seq)
1:length(my_seq)
seq(along.with = my_seq)
seq_along(my_seq)
rep(0,times=40)
rep(c(0,1,2),times=10)
Try rep(c(0, 1, 2),each = 10)
rep(c(0, 1, 2),each = 10)
library(ggplot2)
library(RColorBrewer)
directory <- "F://Drive//Business//Inflacao//Output//"
fontes <- list.files(directory,,pattern="csv")
base <-NULL
for (i in 1:10){
dest <- paste(directory, fontes[i], sep="")
b1 <- read.csv(dest, sep=";", header=FALSE)
base <- rbind(base,b1)
}
nomes <-  c("Fonte","Data","hora","Cat","Sku","Preço")
colnames(base)<-nomes
BaseS <- split(base,base$Data)
Observacoes <- lapply(BaseS,nrow)
Obs<- as.numeric(Observacoes)
dias <- names(Observacoes)
Tempo <- as.Date(dias[1],"%d/%m/%Y")
for (i in 1:length(Obs)){
Tempo[i] <- as.Date(dias[i],"%d/%m/%Y")
}
#dias <- lapply(dias,as.Date,"%d/%m/%Y")
#dias <- unlist(dias)
plotar <- data.frame(dias=Tempo,Obs=Obs)
scale_fill_manual(values=cbPalette)
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")+scale_fill_brewer()
print(Tempo[length(Tempo)]
print(Tempo[length(Tempo)])
length(Tempo)
Tempo
print(max(Tempo))
?ddply
?which
base %>% group_by(Sku)
library(dplyr)
base %>% group_by(Sku)
base %>% group_by(Data)
base %>% group_by(Data) %>% mutate(P_yest=c(NA,Preço[-length(Preço)]))
base %>% filter(Data=="03/03/2015")
filter(base,Data=="03/03/2015")
filter(base,Data==03/03/2015)
filter(base,cat=="BEBIDAS")
class(base)
filter(BaseS,cat=="BEBIDAS")
filter(base,cat=="BEBIDAS")
filter(base,cat=="BEBIDAS")
?filter
filter(base,cat == "BEBIDAS")
filter(base,Fonte == "comperdelivery_DF")
head(base)
filter(base, Data == "03/03/2015")
library(ggplot2)
library(RColorBrewer)
directory <- "F://Drive//Business//Inflacao//Output//"
fontes <- list.files(directory,,pattern="csv")
base <-NULL
for (i in 1:10){
dest <- paste(directory, fontes[i], sep="")
b1 <- read.csv(dest, sep=";", header=FALSE)
base <- rbind(base,b1)
}
nomes <-  c("Fonte","Data","hora","Cat","Sku","Preço")
colnames(base)<-nomes
BaseS <- split(base,base$Data)
Observacoes <- lapply(BaseS,nrow)
Obs<- as.numeric(Observacoes)
dias <- names(Observacoes)
Tempo <- as.Date(dias[1],"%d/%m/%Y")
for (i in 1:length(Obs)){
Tempo[i] <- as.Date(dias[i],"%d/%m/%Y")
}
#dias <- lapply(dias,as.Date,"%d/%m/%Y")
#dias <- unlist(dias)
plotar <- data.frame(dias=Tempo,Obs=Obs)
scale_fill_manual(values=cbPalette)
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")+scale_fill_brewer()
print(max(Tempo))
filter(base, Data == "03/03/2015")
filter(base, Fonte == "comperdelivery_DF", Data == "03/03/2015")
nrows(filter(base, Fonte == "comperdelivery_DF", Data == "03/03/2015"))
nrow(filter(base, Fonte == "comperdelivery_DF", Data == "03/03/2015"))
library(ggplot2)
library(RColorBrewer)
directory <- "F://Drive//Business//Inflacao//Output//"
fontes <- list.files(directory,,pattern="csv")
base <-NULL
for (i in 1:10){
dest <- paste(directory, fontes[i], sep="")
b1 <- read.csv(dest, sep=";", header=FALSE)
base <- rbind(base,b1)
}
nomes <-  c("Fonte","Data","hora","Cat","Sku","Preço")
colnames(base)<-nomes
BaseS <- split(base,base$Data)
Observacoes <- lapply(BaseS,nrow)
Obs<- as.numeric(Observacoes)
dias <- names(Observacoes)
Tempo <- as.Date(dias[1],"%d/%m/%Y")
for (i in 1:length(Obs)){
Tempo[i] <- as.Date(dias[i],"%d/%m/%Y")
}
#dias <- lapply(dias,as.Date,"%d/%m/%Y")
#dias <- unlist(dias)
plotar <- data.frame(dias=Tempo,Obs=Obs)
scale_fill_manual(values=cbPalette)
ggplot(data=plotar,aes(x=Tempo, y=Obs))+geom_bar(stat="identity", colour="darkblue")+scale_fill_brewer()
print(max(Tempo))
nrow(filter(base, Fonte == "comperdelivery_DF", Data == "04/03/2015"))
library(dplyr)
nrow(filter(base, Fonte == "comperdelivery_DF", Data == "04/03/2015"))
nrow(filter(base, Data == "04/03/2015"))
base %>% group_by(fonte)
base %>% group_by(Fonte)
base %>% filter(Fonte)
base,
base %>% filter(Fonte)
base %>% select(Fonte)
base %>% group_by(Fonte) %>% summarise(Fonte)
base %>% summarise(Fonte)
base %>% n(Fonte)
base %>% group_by(Fonte)
base %>% group_by(Fonte) %>% select(Data="04/03/2015")
base %>% group_by(Fonte) %>% select(Data)
base %>% group_by(Fonte) %>% filter(Data)
base %>% group_by(Fonte) %>% filter(Data="04/03/2015")
base %>%  filter(Data="04/03/2015")
nrow(filter(base, Fonte == "comperdelivery_DF", Data == "04/03/2015"))
base %>% group_by(Fonte, Data) %>% summarise(counts=n())
base %>% group_by(Fonte, Data) %>% filter(Data=="04/03/2015") %>% summarise(counts=n())
base %>% group_by(Fonte, Data) %>% filter(Data=="04/03/2015" |Data=="03/03/2015") %>% summarise(counts=n())
max(base$Data)
max(base[Data])
max(base[[Data]])
max(base[[$Data]])
max(base[[Data]])
base[[Data]]
base$Data
?max
max(base$Data)
Tempo
max( Tempo[Tempo!=max(Tempo)] )
Hoje  <- max(Tempo))
Ontem <- max(Tempo[Tempo!=max(Tempo)] )
nrow(filter(base, Fonte == "comperdelivery_DF", Data == "04/03/2015"))
base %>% group_by(Fonte, Data) %>% filter(Data== Hoje |Data== Ontem) %>% summarise(counts=n())
Hoje  <- max(Tempo))
Hoje  <- max(Tempo)
Ontem <- max(Tempo[Tempo!=max(Tempo)] )
nrow(filter(base, Fonte == "comperdelivery_DF", Data == "04/03/2015"))
base %>% group_by(Fonte, Data) %>% filter(Data== Hoje |Data== Ontem) %>% summarise(counts=n())
warnings()
base %>% group_by(Fonte, Data) %>% filter(Data == Hoje |Data == Ontem) %>% summarise(counts=n())
Hoje  <- as.date(max(Tempo))
Hoje  <- as.Date(max(Tempo))
Ontem <- as.Date(max(Tempo[Tempo!=max(Tempo)] ))
nrow(filter(base, Fonte == "comperdelivery_DF", Data == "04/03/2015"))
base %>% group_by(Fonte, Data) %>% filter(Data == Hoje |Data == Ontem) %>% summarise(counts=n())
Hoje  <- as.character(max(Tempo))
Ontem <- as.character(max(Tempo[Tempo!=max(Tempo)] ))
base %>% group_by(Fonte, Data) %>% filter(Data == Hoje |Data == Ontem) %>% summarise(counts=n())
base %>% group_by(Fonte, Data) %>% filter(Data == Hoje | Data == Ontem) %>% summarise(counts=n())
library(xlsx)
library(xlsx)
setwd("F:/Drive/ML-Conf/ML-Conferencia")
jj <- read.xlsx("Pasta2.xlsx")
jj <- read.xlsx("Pasta2.xlsx",1)
jj <- read.xlsx("Pasta2.xlsx",1)
setwd("F:/Drive/ML-Conf/ML-Conferencia/")
jj <- read.xlsx("Pasta2.xlsx",1)
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre7')
jj <- read.xlsx("Pasta2.xlsx",1)
require(rJava)
.jcall('java.lang.System','S','getProperty','java.version')
jj <- read.xlsx("F://Drive//ML-Conf//ML-Conferencia//Pasta2.xlsx",1)
jj <- read.xlsx("F://Drive//NY3.xlsx",1)
lft <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/LFT_2015.xls"
ltn <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/LTN_2015.xls"
ntnbp <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/NTN-B_Principal_2015.xls"
dLFT <- "LFT_2015.xls"
dLTN <- "LTN_2015.xls"
dNTN <- "NTNBP_2015.xls"
lft <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/LFT_2015.xls"
ltn <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/LTN_2015.xls"
ntnbp <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/NTN-B_Principal_2015.xls"
dLFT <- "LFT_2015.xls"
dLTN <- "LTN_2015.xls"
dNTN <- "NTNBP_2015.xls"
library(xlsx)
temp <- tempfile()
download.file(lft,temp, mode="wb")
jj <- read.xlsx(temp,1,startRow=2)
.jmethods(jj)
wb <- createWorkbook()
.jmethods(wb)
temp$getNumberofSheets()
jj$getNumberofSheets()
wb$getNumberofSheets()
wb$getNumberOfSheets()
jj$getNumberOfSheets()
temp$getNumberOfSheets()
temp <- tempfile()
t <- download.file(ltn,temp, mode="wb")
t$getNumberOfSheets()
jj <- read.xlsx(temp,1,startRow=2)
P <- jj$PU.Venda.ManhÃ[length(jj$PU.Venda.ManhÃ)]
loadWorkbook(temp)
$getNumberOfSheets()
loadWorkbook(temp) %>% $getNumberOfSheets()
loadWorkbook(temp) %>% getNumberOfSheets()
t <- loadWorkbook(temp)
t$getNumberOfSheets()
t$.getActiveSheetIndex()
t$getActiveSheetIndex()
t$getNameIndex()
getSheets(t)
sheets <- getSheets(t)
names(sheets)
sheets <- names(getSheets(t))
Res <- NULL
for (i in 1:length(sheets)){
jj <- read.xlsx(temp,i,startRow=2)
P <- jj$PU.Venda.ManhÃ[length(jj$PU.Venda.ManhÃ)]
Data <- as.Date(jj$Dia[length(jj$Dia)],"%d/%m/%Y")
Res <- rbind(c(sheets[i], as.character(Data),P),Res)
}
Res
lista <- as.list(tits = c(lft,ltn,ntnp)
lista <- as.list(tits = c(lft,ltn,ntnp))
?as.list
lista <- as.list(LFT = lft))
lista <- as.list(LFT = lft)
lista <- list(tits = c(lft,ltn,ntnbp))
lista[1]
lista[1][1]
lista[[1]][1]
lista[[1]]
lista[[1]][1]
lista[[1]][2]
Res <- NULL
for (ii in 1:length(lista)){
temp <- tempfile()
t <- download.file(lista[[1]][i],temp, mode="wb")
#carrega as sheets da pasta
t <- loadWorkbook(temp)
sheets <- names(getSheets(t))
for (i in 1:length(sheets)){
jj <- read.xlsx(temp,i,startRow=2)
P <- jj$PU.Venda.ManhÃ[length(jj$PU.Venda.ManhÃ)]
Data <- as.Date(jj$Dia[length(jj$Dia)],"%d/%m/%Y")
Res <- rbind(c(sheets[i], as.character(Data),P),Res)
}
}
res
Res
length(lista)
nrow(lista)
length(lista[[1]])
Res <- NULL
for (ii in 1:length(lista[[1]])){
temp <- tempfile()
t <- download.file(lista[[1]][i],temp, mode="wb")
#carrega as sheets da pasta
t <- loadWorkbook(temp)
sheets <- names(getSheets(t))
for (i in 1:length(sheets)){
jj <- read.xlsx(temp,i,startRow=2)
P <- jj$PU.Venda.ManhÃ[length(jj$PU.Venda.ManhÃ)]
Data <- as.Date(jj$Dia[length(jj$Dia)],"%d/%m/%Y")
Res <- rbind(c(sheets[i], as.character(Data),P),Res)
}
}
Res
t <- download.file(lista[[1]][i],temp, mode="wb")
lista[[1]][i]
Res <- NULL
for (ii in 1:length(lista[[1]])){
temp <- tempfile()
t <- download.file(lista[[1]][ii],temp, mode="wb")
#carrega as sheets da pasta
t <- loadWorkbook(temp)
sheets <- names(getSheets(t))
for (i in 1:length(sheets)){
jj <- read.xlsx(temp,i,startRow=2)
P <- jj$PU.Venda.ManhÃ[length(jj$PU.Venda.ManhÃ)]
Data <- as.Date(jj$Dia[length(jj$Dia)],"%d/%m/%Y")
Res <- rbind(c(sheets[i], as.character(Data),P),Res)
}
}
Res
lft <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/LFT_2015.xls"
ltn <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/LTN_2015.xls"
ntnbp <- "https://www.tesouro.fazenda.gov.br/documents/10180/137713/NTN-B_Principal_2015.xls"
setwd("C://Users//sandor.caetano//Google Drive//R//TD//")
lista <- list(tits = c(lft,ltn,ntnbp))
library(xlsx)
Res <- NULL
for (ii in 1:length(lista[[1]])){
temp <- tempfile()
t <- download.file(lista[[1]][ii],temp, mode="wb")
#carrega as sheets da pasta
t <- loadWorkbook(temp)
sheets <- names(getSheets(t))
for (i in 1:length(sheets)){
jj <- read.xlsx(temp,i,startRow=2)
P <- jj$PU.Venda.ManhÃ[length(jj$PU.Venda.ManhÃ)]
Data <- as.Date(jj$Dia[length(jj$Dia)],"%d/%m/%Y")
Res <- rbind(c(sheets[i], as.character(Data),P),Res)
}
}
Res
